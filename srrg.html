<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
    <!-- Replace the content tag with appropriate information -->
    <meta name="description" content="Automated Structured Report Generation">
    <meta property="og:title" content="SRRG"/>
    <meta property="og:description" content="SRRG: Automated Structured Report Generation"/>
    <meta property="og:url" content="URL OF THE WEBSITE"/>
    <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X630-->
    <meta property="og:image" content=""/>
    <meta property="og:image:width" content="1200"/>
    <meta property="og:image:height" content="630"/>


    <meta name="twitter:title" content="SRRG">
    <meta name="twitter:description" content="Automated Structured Report Generation">
    <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X600-->
    <meta name="twitter:card" content="summary_large_image">
    <!-- Keywords for your paper to be indexed by-->
    <meta name="keywords" content="Radiology Report Generation, LLM, Evaluation">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>Automated Structured Report Generation</title>
    <link rel="icon" type="image/x-icon" href="src/static-chexagent/images/favicon.png">
    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

    <link rel="stylesheet" href="src/static-chexagent/css/bulma.min.css">
    <link rel="stylesheet" href="src/static-chexagent/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="src/static-chexagent/css/bulma-slider.min.css">
    <link rel="stylesheet" href="src/static-chexagent/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="src/static-chexagent/css/index.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
    <script defer src="src/static-chexagent/js/fontawesome.all.min.js"></script>
    <script src="src/static-chexagent/js/bulma-carousel.min.js"></script>
    <script src="src/static-chexagent/js/bulma-slider.min.js"></script>
    <script src="src/static-chexagent/js/index.js"></script>
</head>
<body>


<section class="hero">
    <div class="hero-body">
        <div class="container is-max-desktop">
            <div class="columns is-centered">
                <div class="column has-text-centered">
                    <h1 class="title is-1 publication-title">Automated Structured Report Generation</h1>
                    <div class="is-size-5 publication-authors">
                        <!-- Paper authors -->
    <!-- Paper authors -->
<span class="author-block"><a href="https://jbdel.github.io/" target="_blank">Jean-Benoit Delbrouck</a><sup>‚ô†‚ô•</sup>,</span>
<span class="author-block"><a href="https://github.com/justin13601" target="_blank">Justin Xu</a><sup>‚ô†</sup>,</span>
<span class="author-block"><a href="" target="_blank">Johannes Moll</a><sup>‚ô†</sup>,</span>
<span class="author-block"><a href="" target="_blank">Alois Thomas</a><sup>‚ô†</sup>,</span>
<span class="author-block"><a href="https://zhjohnchan.github.io/" target="_blank">Zhihong Chen</a><sup>‚ô†</sup>,</span>
<span class="author-block"><a href="https://scholar.google.com/citations?user=Q2SCA-sAAAAJ&hl=en" target="_blank">Sophie Ostmeier</a><sup>‚ô†</sup>,</span>
<span class="author-block"><a href="" target="_blank">Asfandyar Azhar</a><sup>‚ô†</sup>,</span>
<span class="author-block"><a href="" target="_blank">Kelvin Zhenghao Li</a><sup>‚ô†</sup>,</span>
<span class="author-block"><a href="" target="_blank">Andrew Johnston</a><sup>‚ô†</sup>,</span>
<span class="author-block"><a href="" target="_blank">Eduardo Reis</a><sup>‚ô†</sup>,</span>
<span class="author-block"><a href="https://scholar.google.ch/citations?user=ao8Yld4AAAAJ&hl=de" target="_blank">Christian Bluethgen</a><sup>‚ô†</sup>,</span>
<span class="author-block"><a href="" target="_blank">Mohamed Muneer</a><sup>‚ô†</sup>,</span>
<span class="author-block"><a href="https://maya-varma.com/" target="_blank">Maya Varma</a><sup>‚ô†</sup>,</span>
<span class="author-block"><a href="https://profiles.stanford.edu/curtis-langlotz" target="_blank">Curtis Langlotz</a><sup>‚ô†</sup></span>

                    </div>

                    <div class="is-size-5 publication-authors">
                        <span class="author-block"><sup>‚ô†</sup>Stanford AIMI &nbsp;&nbsp;|&nbsp;&nbsp; <sup>‚ô•</sup>HOPPR</span>
                    </div>

                    <div class="column has-text-centered">
                        <div class="publication-links">
                            <!-- ArXiv abstract Link -->
                            <span class="link-block">
                                <a href="https://arxiv.org/pdf/2505.24223" target="_blank"
                                   class="external-link button is-normal is-rounded is-dark">
                                    <span class="icon">
                                        <i class="ai ai-arxiv"></i>
                                    </span>
                                    <span>arXiv</span>
                                </a>
                            </span>

                            <!-- Github link -->
                            <span class="link-block">
                                <a href="https://github.com/jbdel/StructEval/tree/main" target="_blank"
                                   class="external-link button is-normal is-rounded is-dark">
                                    <span class="icon">
                                        <i class="fab fa-github"></i>
                                    </span>
                                    <span>Code</span>
                                </a>
                            </span>

                            <!-- HuggingFace link -->
                            <span class="link-block">
                                <a href="https://huggingface.co/collections/StanfordAIMI/structured-radiology-reports-6700962eed728b791126e500" target="_blank"
                                   class="external-link button is-normal is-rounded is-dark">
                                    <span class="icon">
                                        <i class="fas fa-smile"></i>
                                    </span>
                                    <span>HuggingFace</span>
                                </a>
                            </span>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>


<!-- Paper abstract -->
<section class="section hero is-light">
    <div class="container is-max-desktop">
        <div class="columns is-centered has-text-centered">
            <div class="column is-four-fifths">
                <h2 class="title is-3">Abstract</h2>
                <div class="content has-text-justified">
                    <p>
                        Automated radiology report generation from chest X-ray (CXR) images has the potential to improve clinical efficiency and reduce radiologists' workload. However, most datasets, including the publicly available MIMIC-CXR and CheXpert Plus, consist entirely of free-form reports, which are inherently variable and unstructured. This variability poses challenges for both generation and evaluation: existing models struggle to produce consistent, clinically meaningful reports, and standard evaluation metrics fail to capture the nuances of radiological interpretation. To address this, we introduce Structured Radiology Report Generation (SRRG), a new task that reformulates free-text radiology reports into a standardized format, ensuring clarity, consistency, and structured clinical reporting. We create a novel dataset by restructuring reports using large language models (LLMs) following strict structured reporting desiderata. Additionally, we introduce SRR-BERT, a fine-grained disease classification model trained on 55 labels, enabling more precise and clinically informed evaluation of structured reports. To assess report quality, we propose F1-SRR-BERT, a metric that leverages SRR-BERT‚Äôs hierarchical disease taxonomy to bridge the gap between free-text variability and structured clinical reporting. We validate our dataset through a reader study conducted by five board-certified radiologists and extensive benchmarking experiments.
                        <figure>
                        <img src="src/static-srrg/srrg_main.jpg" width="100%" alt="Overview" class="center-image blend-img-background">
                    </figure>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- End paper abstract -->

<!-- CheXinstruct -->
<section class="section hero">
    <div class="container is-max-desktop">
        <div class="columns is-centered has-text-centered">
            <div class="column is-four-fifths">
                <h2 class="title is-3">Report Generation</h2>
                <div class="content has-text-justified">
                  <p>
                    Dataset:
                  </p>
                  <p>
                    <table style="font-size: 14px; width:100%; border-collapse: collapse; text-align: left; font-family: Arial, sans-serif;">
                      <thead style="background-color: #cce5ff;">
                        <tr>
                          <th style="padding: 10px; border-bottom: 2px solid #999;">Dataset</th>
                          <th style="padding: 10px; border-bottom: 2px solid #999;">Split</th>
                          <th style="padding: 10px; border-bottom: 2px solid #999;">Num. Examples</th>
                        </tr>
                      </thead>
                      <tbody>
                        <!-- SRRG-Impression -->
                        <tr>
                          <td rowspan="5" style="padding: 10px; vertical-align: middle;">
                            SRRG-Impression
                          </td>
                          <td style="padding: 10px; background-color: #f9f9f9;">Train</td>
                          <td style="padding: 10px; background-color: #f9f9f9;">405,972</td>
                        </tr>
                        <tr>
                          <td style="padding: 10px;">Validate</td>
                          <td style="padding: 10px;">1,505</td>
                        </tr>
                        <tr>
                          <td style="padding: 10px; background-color: #f9f9f9;">Test</td>
                          <td style="padding: 10px; background-color: #f9f9f9;">2,219</td>
                        </tr>
                        <tr>
                          <td style="padding: 10px;">Test Reviewed</td>
                          <td style="padding: 10px;">231</td>
                        </tr>
                        <tr>
                          <td style="padding: 10px; background-color: #f9f9f9;"><strong>Total</strong></td>
                          <td style="padding: 10px; background-color: #f9f9f9;"><strong>409,927</strong></td>
                        </tr>
                    
                        <!-- SRRG-Findings -->
                        <tr>
                          <td rowspan="5" style="padding: 10px; vertical-align: middle; border-top: 1px solid #ddd;">
                            SRRG-Findings
                          </td>
                          <td style="padding: 10px; background-color: #f9f9f9;">Train</td>
                          <td style="padding: 10px; background-color: #f9f9f9;">181,874</td>
                        </tr>
                        <tr>
                          <td style="padding: 10px;">Validate</td>
                          <td style="padding: 10px;">976</td>
                        </tr>
                        <tr>
                          <td style="padding: 10px; background-color: #f9f9f9;">Test</td>
                          <td style="padding: 10px; background-color: #f9f9f9;">1,459</td>
                        </tr>
                        <tr>
                          <td style="padding: 10px;">Test Reviewed</td>
                          <td style="padding: 10px;">233</td>
                        </tr>
                        <tr>
                          <td style="padding: 10px; background-color: #f9f9f9;"><strong>Total</strong></td>
                          <td style="padding: 10px; background-color: #f9f9f9;"><strong>184,542</strong></td>
                        </tr>
                      </tbody>
                    </table>
                    
                  </p>
                  <p>We release multiple models for SRRG-Impression and SRRG-Findings. 
                    <p>
                        <table style="font-size: 14px; width:100%; border-collapse: collapse; text-align: left; font-family: Arial, sans-serif;">
                            <thead style="background-color: #cce5ff;">
                              <tr>
                                <th style="padding: 10px; border-bottom: 2px solid #999;">Model Family</th>
                                <th style="padding: 10px; border-bottom: 2px solid #999;">Dataset Variant</th>
                                <th style="padding: 10px; border-bottom: 2px solid #999;">Model</th>
                              </tr>
                            </thead>
                            <tbody>
                              <!-- CheXagent -->
                              <tr>
                                <td rowspan="2" style="padding: 10px; font-weight: bold; vertical-align: middle;">CheXagent</td>
                                <td style="padding: 10px;">
                                  <a href="https://huggingface.co/datasets/StanfordAIMI/srrg_impression" target="_blank">
                                    SRRG-Impression
                                  </a>
                                </td>
                                <td style="padding: 10px;">
                                  <a href="https://huggingface.co/StanfordAIMI/CheXagent-2-3b-srrg-impression" target="_blank">
                                    ü§ó StanfordAIMI/CheXagent-2-3b-srrg-impression
                                  </a>
                                </td>
                              </tr>
                              <tr>
                                <td style="padding: 10px;">
                                  <a href="https://huggingface.co/datasets/StanfordAIMI/srrg_findings" target="_blank">
                                    SRRG-Findings
                                  </a>
                                </td>
                                <td style="padding: 10px;">
                                  <a href="https://huggingface.co/StanfordAIMI/CheXagent-2-3b-srrg-findings" target="_blank">
                                    ü§ó StanfordAIMI/CheXagent-2-3b-srrg-findings
                                  </a>
                                </td>
                              </tr>
                          
                              <!-- CheXpert-Plus -->
                              <tr>
                                <td rowspan="2" style="padding: 10px; font-weight: bold; vertical-align: middle;">CheXpert-Plus</td>
                                <td style="padding: 10px;">
                                  <a href="https://huggingface.co/datasets/StanfordAIMI/srrg_impression" target="_blank">
                                    SRRG-Impression
                                  </a>
                                </td>
                                <td style="padding: 10px;">
                                  <a href="https://huggingface.co/StanfordAIMI/chexpert-plus-srrg_impression" target="_blank">
                                    ü§ó StanfordAIMI/chexpert-plus-srrg_impression
                                  </a>
                                </td>
                              </tr>
                              <tr>
                                <td style="padding: 10px;">
                                  <a href="https://huggingface.co/datasets/StanfordAIMI/srrg_findings" target="_blank">
                                    SRRG-Findings
                                  </a>
                                </td>
                                <td style="padding: 10px;">
                                  <a href="https://huggingface.co/StanfordAIMI/chexpert-plus-srrg_findings" target="_blank">
                                    ü§ó StanfordAIMI/chexpert-plus-srrg_findings
                                  </a>
                                </td>
                              </tr>
                          
                              <!-- MAIRA-2 -->
                              <tr>
                                <td rowspan="2" style="padding: 10px; font-weight: bold; vertical-align: middle;">MAIRA-2</td>
                                <td style="padding: 10px;">
                                  <a href="https://huggingface.co/datasets/StanfordAIMI/srrg_impression" target="_blank">
                                    SRRG-Impression
                                  </a>
                                </td>
                                <td style="padding: 10px;">
                                  <a href="https://huggingface.co/StanfordAIMI/maira2-srrg-impression" target="_blank">
                                    ü§ó StanfordAIMI/maira2-srrg-impression
                                  </a>
                                </td>
                              </tr>
                              <tr>
                                <td style="padding: 10px;">
                                  <a href="https://huggingface.co/datasets/StanfordAIMI/srrg_findings" target="_blank">
                                    SRRG-Findings
                                  </a>
                                </td>
                                <td style="padding: 10px;">
                                  <a href="https://huggingface.co/StanfordAIMI/maira2-srrg-findings" target="_blank">
                                    ü§ó StanfordAIMI/maira2-srrg-findings
                                  </a>
                                </td>
                              </tr>
                            </tbody>
                          </table>
                          
                    </p>
                    <p>Example usage:</p>
                    <p>
                      <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="font-size: 12px; margin: 0; line-height: 125%"><span style="color: #0000ff">import</span> io
<span style="color: #0000ff">import</span> requests
<span style="color: #0000ff">import</span> torch
<span style="color: #0000ff">from</span> PIL <span style="color: #0000ff">import</span> Image
<span style="color: #0000ff">from</span> transformers <span style="color: #0000ff">import</span> AutoModelForCausalLM, AutoTokenizer
<span style="color: #0000ff">import</span> tempfile

<span style="color: #008000"># step 1: Setup constants</span>
model_name = <span style="color: #a31515">&quot;StanfordAIMI/CheXagent-2-3b-srrg-findings&quot;</span>
dtype = torch.bfloat16
device = <span style="color: #a31515">&quot;cuda&quot;</span>

<span style="color: #008000"># step 2: Load Processor and Model</span>
tokenizer = AutoTokenizer.from_pretrained(model_name, trust_remote_code=True)
model = AutoModelForCausalLM.from_pretrained(model_name, device_map=<span style="color: #a31515">&quot;auto&quot;</span>, trust_remote_code=True)
model = model.to(dtype)
model.eval()

<span style="color: #008000"># step 3: Download image from URL, save to a local file, and prepare path list</span>
url = <span style="color: #a31515">&quot;https://huggingface.co/IAMJB/interpret-cxr-impression-baseline/resolve/main/effusions-bibasal.jpg&quot;</span>
resp = requests.get(url)
resp.raise_for_status()

<span style="color: #008000"># Use a NamedTemporaryFile so it lives on disk</span>
<span style="color: #0000ff">with</span> tempfile.NamedTemporaryFile(delete=False, suffix=<span style="color: #a31515">&quot;.jpg&quot;</span>) <span style="color: #0000ff">as</span> tmpfile:
    tmpfile.write(resp.content)
    local_path = tmpfile.name  <span style="color: #008000"># this is a real file path on disk</span>

paths = [local_path]

prompt = <span style="color: #a31515">&quot;Structured Radiology Report Generation for Findings Section&quot;</span>
<span style="color: #008000"># build the multimodal input</span>
query = tokenizer.from_list_format(
    [*([{<span style="color: #a31515">&quot;image&quot;</span>: img} <span style="color: #0000ff">for</span> img <span style="color: #0000ff">in</span> paths]), {<span style="color: #a31515">&quot;text&quot;</span>: prompt}]
)

<span style="color: #008000"># format as a chat conversation</span>
conv = [
    {<span style="color: #a31515">&quot;from&quot;</span>: <span style="color: #a31515">&quot;system&quot;</span>, <span style="color: #a31515">&quot;value&quot;</span>: <span style="color: #a31515">&quot;You are a helpful assistant.&quot;</span>},
    {<span style="color: #a31515">&quot;from&quot;</span>: <span style="color: #a31515">&quot;human&quot;</span>, <span style="color: #a31515">&quot;value&quot;</span>: query},
]

<span style="color: #008000"># tokenize and generate</span>
input_ids = tokenizer.apply_chat_template(
    conv, add_generation_prompt=True, return_tensors=<span style="color: #a31515">&quot;pt&quot;</span>
)
output = model.generate(
    input_ids.to(device),
    do_sample=False,
    num_beams=1,
    temperature=1.0,
    top_p=1.0,
    use_cache=True,
    max_new_tokens=512,
)[0]

<span style="color: #008000"># decode the ‚Äúfindings‚Äù text</span>
response = tokenizer.decode(output[input_ids.size(1) : -1])
<span style="color: #0000ff">print</span>(response)
</pre></div>

                    </p>
                    <p>Response:</p>
<p><!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="font-size: 12px; margin: 0; line-height: 125%">Lungs and Airways:
  - No evidence of pneumothorax.
  
  Pleura:
  - Bilateral pleural effusions.
  
  Cardiovascular:
  - Cardiomegaly.
  
  Other:
  - Bibasilar opacities.
  - Mild pulmonary edema.
  </pre></div>
  </p>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- End CheXinstruct -->

<!-- CheXbench -->
<section class="section hero">
    <div class="container is-max-desktop">
        <div class="columns is-centered has-text-centered">
            <div class="column is-four-fifths">
                <h2 class="title is-3">F1-SRR-BERT</h2>
                <div class="content has-text-justified">
                    <p>
                        <table style="font-size: 14px; width:100%; border-collapse: collapse; text-align: left; font-family: Arial, sans-serif;">
                            <thead style="background-color: #cce5ff;">
                              <tr>
                                <th style="padding: 10px; border-bottom: 2px solid #999;">Model</th>
                                <th style="padding: 10px; border-bottom: 2px solid #999;"># Classes (cf <a href="#ontology">ontology</a>)</th>
                                <th style="padding: 10px; border-bottom: 2px solid #999;">Weighted Scores (P / R / F1 / Support)</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <td style="padding: 10px;">
                                  <a href="https://huggingface.co/StanfordAIMI/SRR-BERT-Leaves" target="_blank">
                                    ü§ó StanfordAIMI/SRR-BERT-Leaves
                                  </a>
                                </td>
                                <td style="padding: 10px;">54</td>
                                <td style="padding: 10px;">0.91 / 0.92 / 0.91 / 178,303</td>
                              </tr>
                              <tr>
                                <td style="padding: 10px;">
                                  <a href="https://huggingface.co/StanfordAIMI/SRR-BERT-Upper" target="_blank">
                                    ü§ó StanfordAIMI/SRR-BERT-Upper
                                  </a>
                                </td>
                                <td style="padding: 10px;">24</td>
                                <td style="padding: 10px;">0.92 / 0.92 / 0.92 / 169,849</td>
                              </tr>
                              <tr>
                                <td style="padding: 10px;">
                                  <a href="https://huggingface.co/StanfordAIMI/SRR-BERT-Leaves-with-Statuses" target="_blank">
                                    ü§ó StanfordAIMI/SRR-BERT-Leaves-with-Statuses
                                  </a>
                                </td>
                                <td style="padding: 10px;">162</td>
                                <td style="padding: 10px;">0.89 / 0.88 / 0.88 / 178,346</td>
                              </tr>
                              <tr>
                                <td style="padding: 10px;">
                                  <a href="https://huggingface.co/StanfordAIMI/SRR-BERT-Upper-with-Statuses" target="_blank">
                                    ü§ó StanfordAIMI/SRR-BERT-Upper-with-Statuses
                                  </a>
                                </td>
                                <td style="padding: 10px;">72</td>
                                <td style="padding: 10px;">0.89 / 0.88 / 0.88 / 168,454</td>
                              </tr>
                            </tbody>
                          </table>
                          
                          
                          <table style="font-size: 14px; width:100%; border-collapse: collapse; text-align: left; font-family: Arial, sans-serif;">
                            <thead style="background-color: #cce5ff;">
                              <tr>
                                <th style="padding: 10px; border-bottom: 2px solid #999;">Dataset</th>
                                <th style="padding: 10px; border-bottom: 2px solid #999;">Split</th>
                                <th style="padding: 10px; border-bottom: 2px solid #999;">Num. Examples</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <td rowspan="5" style="padding: 10px; vertical-align: middle;">
                                  <a href="https://huggingface.co/datasets/StanfordAIMI/StructUtterances" target="_blank">
                                    ü§ó StanfordAIMI/StructUtterances
                                  </a>
                                </td>
                                <td style="padding: 10px; background-color: #f9f9f9;">Train</td>
                                <td style="padding: 10px; background-color: #f9f9f9;">1,203,332</td>
                              </tr>
                              <tr>
                                <td style="padding: 10px;">Validate</td>
                                <td style="padding: 10px;">150,417</td>
                              </tr>
                              <tr>
                                <td style="padding: 10px; background-color: #f9f9f9;">Test</td>
                                <td style="padding: 10px; background-color: #f9f9f9;">150,417</td>
                              </tr>
                              <tr>
                                <td style="padding: 10px;">Test Reviewed</td>
                                <td style="padding: 10px;">1,609</td>
                              </tr>
                              <tr>
                                <td style="padding: 10px; background-color: #f9f9f9;"><strong>Total</strong></td>
                                <td style="padding: 10px; background-color: #f9f9f9;"><strong>1,506,158</strong></td>
                              </tr>
                            </tbody>
                          </table>
               
                          
                    </p>
             <p>The evaluation script of F1-SRR-BERT is available <a href="https://github.com/jbdel/StructEval/blob/main/structeval/evaluation.py" target="_blank">here</a>.</p>
                
            <p>Example usage:</p>
            <p>
              <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="font-size: 12px; margin: 0; line-height: 125%"><span style="color: #0000ff">import</span> json
<span style="color: #0000ff">import</span> torch
<span style="color: #0000ff">from</span> transformers <span style="color: #0000ff">import</span> BertTokenizer, BertForSequenceClassification
<span style="color: #0000ff">from</span> datasets <span style="color: #0000ff">import</span> load_dataset
<span style="color: #0000ff">import</span> requests

<span style="color: #008000"># Configuration</span>
MODEL_PATH = <span style="color: #a31515">&quot;StanfordAIMI/SRRG-BERT-Upper-with-Statuses&quot;</span>
MAPPING_URL = <span style="color: #a31515">&quot;https://raw.githubusercontent.com/jbdel/StructEval/refs/heads/main/structeval/upper_with_statuses_mapping.json&quot;</span>
MAX_LENGTH = 128
DEVICE = torch.device(<span style="color: #a31515">&quot;cuda&quot;</span> <span style="color: #0000ff">if</span> torch.cuda.is_available() <span style="color: #0000ff">else</span> <span style="color: #a31515">&quot;cpu&quot;</span>)

<span style="color: #008000"># Fetch mapping from GitHub</span>
resp = requests.get(MAPPING_URL)
resp.raise_for_status()
label_map = resp.json()
idx2label = {v: k <span style="color: #0000ff">for</span> k, v <span style="color: #0000ff">in</span> label_map.items()}

<span style="color: #008000"># Load tokenizer &amp; model</span>
tokenizer = BertTokenizer.from_pretrained(<span style="color: #a31515">&quot;microsoft/BiomedVLP-CXR-BERT-general&quot;</span>)
model = BertForSequenceClassification.from_pretrained(MODEL_PATH, num_labels=len(label_map))
model.to(DEVICE).eval()

<span style="color: #008000"># Grab one test sentence</span>
dataset = load_dataset(<span style="color: #a31515">&quot;StanfordAIMI/StructUtterances&quot;</span>, split=<span style="color: #a31515">&quot;test_reviewed&quot;</span>)
sentence = dataset[35][<span style="color: #a31515">&quot;utterance&quot;</span>]

<span style="color: #008000"># Tokenize and infer</span>
inputs = tokenizer(
    sentence,
    padding=<span style="color: #a31515">&quot;max_length&quot;</span>,
    truncation=True,
    max_length=MAX_LENGTH,
    return_tensors=<span style="color: #a31515">&quot;pt&quot;</span>
).to(DEVICE)

<span style="color: #0000ff">with</span> torch.no_grad():
    logits = model(**inputs).logits
    preds = (torch.sigmoid(logits)[0].cpu().numpy() &gt; 0.5).astype(int)

pred_labels = [idx2label[i] <span style="color: #0000ff">for</span> i, flag <span style="color: #0000ff">in</span> enumerate(preds) <span style="color: #0000ff">if</span> flag]

<span style="color: #0000ff">print</span>(f<span style="color: #a31515">&quot;Sentence: {sentence}&quot;</span>)
<span style="color: #0000ff">print</span>(<span style="color: #a31515">&quot;Predicted labels:&quot;</span>, pred_labels)
</pre></div>

            </p>
            <p>Response:</p>
            <p>
              <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="font-size: 12px; margin: 0; line-height: 125%">Sentence: Patchy consolidation in the left retrocardiac area, suggestive of atelectasis or early airspace disease.
Predicted labels: [<span style="color: #a31515">&#39;Consolidation (Uncertain)&#39;</span>, <span style="color: #a31515">&#39;Air space opacity (Uncertain)&#39;</span>]
</pre></div>

            </p>

            <p>Difference between models:</p>
            <p>
              <table style="font-size: 14px; border-collapse: collapse; text-align: left; font-family: Arial, sans-serif;">
                <thead>
                  <tr>
                    <th>Model</th>
                    <th>Predicted&nbsp;Labels</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>ü§ó <a href="https://huggingface.co/StanfordAIMI/SRR-BERT-Leaves">StanfordAIMI/SRR-BERT-Leaves</a></td>
                    <td>Atelectasis;<br>Air&nbsp;space&nbsp;opacity‚Äìmultifocal</td>
                  </tr>
                  <tr>
                    <td>ü§ó <a href="https://huggingface.co/StanfordAIMI/SRR-BERT-Upper">StanfordAIMI/SRR-BERT-Upper</a></td>
                    <td>Consolidation;<br>Air&nbsp;space&nbsp;opacity</td>
                  </tr>
                  <tr>
                    <td>ü§ó <a href="https://huggingface.co/StanfordAIMI/SRR-BERT-Leaves-with-Statuses">StanfordAIMI/SRR-BERT-Leaves-with-Statuses</a></td>
                    <td>Atelectasis&nbsp;(Uncertain);<br>Air&nbsp;space&nbsp;opacity‚Äìmultifocal&nbsp;(Uncertain)</td>
                  </tr>
                  <tr>
                    <td>ü§ó <a href="https://huggingface.co/StanfordAIMI/SRR-BERT-Upper-with-Statuses">StanfordAIMI/SRR-BERT-Upper-with-Statuses</a></td>
                    <td>Consolidation&nbsp;(Uncertain);<br>Air&nbsp;space&nbsp;opacity&nbsp;(Uncertain)</td>
                  </tr>
                </tbody>
              </table>
              
              
            </p>
            </div>
            </div>
        </div>
    </div>
</section>
<!-- End CheXbench -->


<!--BibTex citation -->
<section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
        <h2 class="title">BibTeX</h2>
        <pre><code>@inproceedings{delbrouck-etal-2025-automated,
            title     = "Automated Structured Radiology Report Generation",
            author    = "Delbrouck, Jean-Benoit  and
                         Xu, Justin  and
                         Moll, Johannes  and
                         Thomas, Alois  and
                         Chen, Zhihong  and
                         Ostmeier, Sophie  and
                         Azhar, Asfandyar  and
                         Li, Kelvin Zhenghao  and
                         Johnston, Andrew  and
                         Bluethgen, Christian  and
                         Reis, Eduardo  and
                         Muneer, Mohamed  and
                         Varma, Maya  and
                         Langlotz, Curtis",
            booktitle = "Proceedings of the 63rd Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)",
            year      = "2025",
            publisher = "Association for Computational Linguistics",
        }                 
</code></pre>
    </div>
</section>

<section class="section" id="ontology">
  <div class="container is-max-desktop content">
    <h2 class="title">Ontology:</h2>
    <pre><code>1. No Finding
2. Lung Finding
   2.1. Lung Opacity
       2.1.1. Air space opacity
           2.1.1.1. Diffuse air space opacity
               2.1.1.1.1. Edema
           2.1.1.2. Focal air space opacity
               2.1.1.2.1. Consolidation
                   2.1.1.2.1.1. Pneumonia
                   2.1.1.2.1.2. Atelectasis
                   2.1.1.2.1.3. Aspiration
               2.1.1.2.2. Segmental collapse
                   2.1.1.2.2.1. Lung collapse
               2.1.1.2.3. Perihilar airspace opacity
           2.1.1.3. Air space opacity‚Äìmultifocal
       2.1.2. Masslike opacity
           2.1.2.1. Solitary masslike opacity
               2.1.2.1.1. Mass/Solitary lung mass
               2.1.2.1.2. Nodule/Solitary lung nodule
               2.1.2.1.3. Cavitating mass with content
           2.1.2.2. Multiple masslike opacities
               2.1.2.2.1. Cavitating masses
   2.2. Emphysema
   2.3. Fibrosis
   2.4. Pulmonary congestion
   2.5. Hilar lymphadenopathy
   2.6. Bronchiectasis
3. Pleural Finding
   3.1. Pneumothorax
       3.1.1. Simple pneumothorax
       3.1.2. Loculated pneumothorax
       3.1.3. Tension pneumothorax
   3.2. Pleural Thickening
       3.2.1. Pleural Effusion
           3.2.1.1. Simple pleural effusion
           3.2.1.2. Loculated pleural effusion
       3.2.2. Pleural scarring
   3.3. Hydropneumothorax
   3.4. Pleural Other
4. Widened Cardiac Silhouette
   4.1. Cardiomegaly
   4.2. Pericardial effusion
5. Mediastinal Finding
   5.1. Mediastinal Mass
       5.1.1. Inferior mediastinal mass
       5.1.2. Superior mediastinal mass
   5.2. Vascular Finding
       5.2.1. Widened aortic contour
           5.2.1.1. Tortuous Aorta
       5.2.2. Calcification of the Aorta
       5.2.3. Enlarged pulmonary artery
   5.3. Hernia
   5.4. Pneumomediastinum
   5.5. Tracheal deviation
6. Musculoskeletal Finding
   6.1. Fracture
       6.1.1. Acute humerus fracture
       6.1.2. Acute rib fracture
       6.1.3. Acute clavicle fracture
       6.1.4. Acute scapula fracture
       6.1.5. Compression fracture
   6.2. Shoulder dislocation
   6.3. Chest wall finding
       6.3.1. Subcutaneous Emphysema
7. Support Devices
   7.1. Suboptimal central line
   7.2. Suboptimal endotracheal tube
   7.3. Suboptimal nasogastric tube
   7.4. Suboptimal pulmonary arterial catheter
   7.5. Pleural tube
   7.6. PICC line
   7.7. Port catheter
   7.8. Pacemaker
   7.9. Implantable defibrillator
   7.10. LVAD
   7.11. Intraaortic balloon pump
8. Upper Abdominal Finding
   8.1. Subdiaphragmatic gas
       8.1.1. Pneumoperitoneum
    </code></pre>
  </div>
</section>
<!--End BibTex citation -->


<footer class="footer">
    <div class="container">
        <div class="columns is-centered">
            <div class="column is-8">
                <div class="content">
                    <p>
                        Last update: 2024/05. Template credited to <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a>.
                    </p>
                </div>
            </div>
        </div>
    </div>
</footer>

</body>
</html>
